<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>eRJ — Obsługa pociągu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .tile { cursor:pointer; }
    .hidden { display:none !important; }
    .list-group-item { user-select:none; }
    .small-muted { color:#6c757d; font-size:0.9rem; }
    .panel { min-height:120px; }
    .r7-row { display:flex; justify-content:space-between; align-items:center; gap:8px; padding:6px 8px; border-bottom:1px solid #eee; }
  </style>
</head>
<body>
  <div class="container py-4">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h3 class="mb-0">eRJ — System</h3>
        <div class="small text-muted">Panel testowy</div>
      </div>
      <div>
        <button id="btnHome" class="btn btn-outline-secondary btn-sm">Strona główna</button>
      </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="mb-3">
      <div class="row g-3">
        <div class="col-12 col-md-4">
          <div id="tileHandleTrain" class="card tile p-3">
            <h5>Obsłuż pociąg</h5>
            <div class="small-muted">Tworzenie raportów i wykazów R-7</div>
          </div>
        </div>

        <div class="col-12 col-md-4">
          <div id="tileTakeOver" class="card tile p-3">
            <h5>Przejmij pociąg</h5>
            <div class="small-muted">Przejmij istniejący raport lub wykaz</div>
          </div>
        </div>

        <div class="col-12 col-md-4">
          <div id="tilePhonebook" class="card tile p-3">
            <h5>Książka telefoniczna</h5>
            <div class="small-muted">Podgląd numerów</div>
          </div>
        </div>
      </div>
    </div>

    <!-- HANDLE TRAIN MENU (only two buttons) -->
    <div id="handleTrainMenu" class="card p-3 mb-3 hidden">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Obsłuż pociąg</h5>
        <div>
          <button id="backFromHandle" class="btn btn-sm btn-outline-secondary">Powrót</button>
          <button id="homeFromHandle" class="btn btn-sm btn-outline-primary">Strona główna</button>
        </div>
      </div>

      <div class="row g-2">
        <div class="col-12 col-md-6">
          <button id="btnNewReport" class="btn btn-primary w-100">Nowy raport</button>
        </div>
        <div class="col-12 col-md-6">
          <button id="btnNewR7" class="btn btn-outline-secondary w-100">Nowy wykaz R-7</button>
        </div>
      </div>
    </div>

    <!-- TAKEOVER MENU (only two actions) -->
    <div id="takeOverMenu" class="card p-3 mb-3 hidden">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Przejmij pociąg</h5>
        <div>
          <button id="backFromTakeover" class="btn btn-sm btn-outline-secondary">Powrót</button>
          <button id="homeFromTakeover" class="btn btn-sm btn-outline-primary">Strona główna</button>
        </div>
      </div>

      <div class="row g-2">
        <div class="col-12 col-md-6">
          <button id="btnTakeoverReport" class="btn btn-primary w-100">Przejmij raport (wyszukaj)</button>
        </div>
        <div class="col-12 col-md-6">
          <button id="btnTakeoverR7" class="btn btn-outline-secondary w-100">Przejmij wykaz R-7 (wyszukaj)</button>
        </div>
      </div>
    </div>

    <!-- REPORT PANEL -->
    <div id="reportPanel" class="card p-3 mb-3 hidden">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Raport z jazdy pociągu</h5>
        <div>
          <button id="rp_back" class="btn btn-sm btn-outline-secondary">Powrót</button>
          <button id="rp_home" class="btn btn-sm btn-outline-primary">Strona główna</button>
        </div>
      </div>

      <div class="mb-2">
        <div class="row g-2">
          <div class="col-6 col-md-3"><label class="form-label small">Numer pociągu</label><input id="rp_trainNumber" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Data</label><input id="rp_date" type="date" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Maszynista</label><input id="rp_driver" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Kierownik</label><input id="rp_conductor" class="form-control"></div>
        </div>
      </div>

      <div class="mb-2">
        <button id="rp_save" class="btn btn-success">Zapisz raport</button>
        <button id="rp_export" class="btn btn-outline-secondary">Eksportuj JSON</button>
      </div>

      <div class="mt-3">
        <h6>Historia zapisów</h6>
        <div id="reportsList" class="list-group"></div>
      </div>
    </div>

    <!-- R-7 CREATION PANEL -->
    <div id="r7CreatePanel" class="card p-3 mb-3 hidden">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Tworzenie wykazu R-7</h5>
        <div>
          <button id="r7_back" class="btn btn-sm btn-outline-secondary">Powrót</button>
          <button id="r7_home" class="btn btn-sm btn-outline-primary">Strona główna</button>
        </div>
      </div>

      <div class="mb-2">
        <div class="row g-2">
          <div class="col-6 col-md-3"><label class="form-label small">Nr pociągu</label><input id="r7_train" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Data</label><input id="r7_date_input" type="date" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Ze stacji</label><input id="r7_from_input" class="form-control"></div>
          <div class="col-6 col-md-3"><label class="form-label small">Do stacji</label><input id="r7_to_input" class="form-control"></div>
        </div>
      </div>

      <div class="mb-2">
        <button id="r7_add_loco" class="btn btn-outline-primary btn-sm">Dodaj lokomotywę</button>
        <button id="r7_add_wagon" class="btn btn-outline-primary btn-sm">Dodaj wagon</button>
        <button id="r7_save" class="btn btn-success btn-sm">Zapisz wykaz R-7</button>
      </div>

      <div class="mt-3">
        <h6>Lista pojazdów</h6>
        <div id="r7Items" class="card panel p-2"></div>
      </div>
    </div>

    <!-- TAKEOVER SEARCH MODAL (simple) -->
    <div id="modalSearch" class="hidden">
      <!-- rendered dynamically -->
    </div>

    <!-- PHONEBOOK PANEL (simple) -->
    <div id="phonebookPanel" class="card p-3 mb-3 hidden">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="mb-0">Książka telefoniczna</h5>
        <div>
          <button id="backFromPhonebook" class="btn btn-sm btn-outline-secondary">Powrót</button>
          <button id="homeFromPhonebook" class="btn btn-sm btn-outline-primary">Strona główna</button>
        </div>
      </div>
      <div class="mt-2">
        <table class="table table-sm">
          <thead><tr><th>Imię</th><th>Stanowisko</th><th>Telefon</th></tr></thead>
          <tbody id="phonebookBody"><tr><td colspan="3" class="text-muted">Brak danych</td></tr></tbody>
        </table>
      </div>
    </div>

    <footer class="mt-4 small text-muted">Wersja testowa</footer>
  </div>

  <script type="module" src="js/app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
